---
/**
 * Page √Ä Propos FR
 * Donn√©es dynamiques depuis Content Collections
 */
import { getEntry, getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import Terminal from '../../components/Terminal';
import AnimatedCounter from '../../components/AnimatedCounter';
import Timeline from '../../components/Timeline';
import ScrollReveal from '../../components/ScrollReveal';
import ParallaxBackground from '../../components/ParallaxBackground';

export const prerender = true;

const lang = 'fr' as const;

// Charger les donn√©es r√©elles depuis Content Collections
const certsEntry = await getEntry('certifications', 'certifications.fr');
const skillsEntry = await getEntry('skills', 'skills.fr');
const allProjects = await getCollection('projects');

const certs = certsEntry?.data ?? [];
const skills = skillsEntry?.data ?? [];
const frProjects = allProjects.filter((p) => p.id.endsWith('.fr.mdx'));

// Stats calcul√©es dynamiquement
const totalSkills = skills.reduce((acc, cat) => acc + cat.skills.length, 0);
const totalCerts = certs.length;
const totalProjects = frProjects.length;
const totalCategories = skills.length;

// Terminal avec comp√©tences r√©elles
const terminalLines = [
  { type: 'command' as const, content: 'whoami', delay: 500 },
  {
    type: 'output' as const,
    content: 'Esdras GBEDOZIN\nIng√©nieur Informatique ‚Äî Full-Stack & Cloud',
    delay: 100,
  },
  { type: 'command' as const, content: 'cat skills.txt', delay: 800 },
  {
    type: 'output' as const,
    content: `‚òÅÔ∏è  Cloud: GCP, Cloud Run, Firestore, Terraform\nüîß Backend: Python, FastAPI, Flask, Java, Node.js\n‚ú® Frontend: React, TypeScript, Astro, Tailwind CSS\nüìä DevOps: Docker, Jenkins, GitHub Actions, CI/CD\nüß™ Tests: Playwright, Selenium, Cypress, PyTest, TDD\nü§ñ IA: Vertex AI, Gemini API, Document AI`,
    delay: 100,
  },
  { type: 'command' as const, content: 'echo $PASSION', delay: 1000 },
  {
    type: 'output' as const,
    content: 'üöÄ Architecturer des solutions cloud-native robustes et √©volutives',
    delay: 100,
  },
];

// Timeline construite depuis les certifications r√©elles
const timelineItems = certs
  .sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime())
  .map((cert) => ({
    title: cert.title,
    date: new Date(cert.date).toLocaleDateString('fr-FR', {
      year: 'numeric',
      month: 'long',
    }),
    description: cert.description ?? `Certification d√©livr√©e par ${cert.organization}`,
    type: 'certification' as const,
  }));
---

<Layout
  title="√Ä Propos - Portfolio"
  description="√Ä propos d'Esdras GBEDOZIN ‚Äî Ing√©nieur Informatique sp√©cialis√© en Cloud, DevOps et d√©veloppement Full-Stack. Parcours, certifications et expertise technique."
  lang={lang}
>
  {/* Hero Section */}
  <ParallaxBackground speed={0.3} variant="gradient" className="py-24" client:idle>
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <ScrollReveal delay={0} client:idle>
        <h1
          class="text-5xl md:text-6xl font-bold text-center mb-6 bg-gradient-to-r from-primary-400 via-purple-500 to-primary-400 gradient-text bg-[length:200%_100%] animate-gradient-text"
        >
          √Ä Propos de Moi
        </h1>
        <p class="text-xl text-center text-neutral-400 max-w-3xl mx-auto leading-relaxed">
          Ing√©nieur informatique passionn√© par l'architecture cloud, le DevOps et le d√©veloppement
          Full-Stack. Je con√ßois des solutions cloud-native robustes avec Python, React et Google
          Cloud Platform.
        </p>
      </ScrollReveal>
    </div>
  </ParallaxBackground>

  {/* Stats Section ‚Äî donn√©es dynamiques */}
  <section class="py-16 bg-neutral-950/50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid grid-cols-2 md:grid-cols-4 gap-8">
        <AnimatedCounter
          end={totalProjects}
          suffix="+"
          label="Projets r√©alis√©s"
          duration={2}
          client:idle
        />
        <AnimatedCounter end={totalCerts} label="Certifications" duration={2} client:idle />
        <AnimatedCounter
          end={totalSkills}
          suffix="+"
          label="Technologies ma√Ætris√©es"
          duration={2.5}
          client:idle
        />
        <AnimatedCounter
          end={totalCategories}
          label="Domaines d'expertise"
          duration={2}
          client:idle
        />
      </div>
    </div>
  </section>

  {/* Terminal Section */}
  <ParallaxBackground speed={0.2} variant="dots" className="py-24" client:idle>
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
      <ScrollReveal delay={0} client:idle>
        <h2
          class="text-4xl font-bold text-center mb-12 bg-gradient-to-r from-primary-400 to-purple-500 gradient-text"
        >
          ~/mon-profil
        </h2>
      </ScrollReveal>

      <ScrollReveal delay={200} client:idle>
        <Terminal lines={terminalLines} prompt="‚ùØ" client:idle />
      </ScrollReveal>
    </div>
  </ParallaxBackground>

  {/* Timeline Section ‚Äî certifications r√©elles */}
  <section class="py-24 bg-neutral-950/50">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <ScrollReveal delay={0} client:idle>
        <h2
          class="text-4xl font-bold text-center mb-4 bg-gradient-to-r from-primary-400 to-purple-500 gradient-text"
        >
          Mon Parcours
        </h2>
        <p class="text-center text-neutral-400 mb-16 max-w-2xl mx-auto">
          Certifications et accomplissements professionnels
        </p>
      </ScrollReveal>

      <Timeline items={timelineItems} linePosition="left" client:idle />
    </div>
  </section>

  {/* CTA Section */}
  <ParallaxBackground speed={0.3} variant="gradient" className="py-24" client:idle>
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <ScrollReveal delay={0} client:idle>
        <h2 class="text-4xl font-bold mb-6 text-neutral-100">Travaillons Ensemble</h2>
        <p class="text-xl text-neutral-400 mb-8 max-w-2xl mx-auto">
          Vous avez un projet ambitieux ? Discutons de la fa√ßon dont je peux vous aider √† le
          r√©aliser.
        </p>
        <a
          href="/fr/contact"
          class="inline-flex items-center gap-2 px-8 py-4 bg-gradient-to-r from-primary-600 to-primary-500 text-white rounded-lg font-medium hover:from-primary-500 hover:to-primary-400 transition-all hover:scale-105 shadow-lg hover:shadow-primary-500/50 text-lg"
        >
          Me Contacter
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
          </svg>
        </a>
      </ScrollReveal>
    </div>
  </ParallaxBackground>
</Layout>
